# Data Splitters æ¨¡å—æ–‡æ¡£

## ğŸ“‹ æ¦‚è¿°

`data_splitters.py` æ˜¯ä¸€ä¸ªä¸“ä¸ºåŒ»ç–—æ•°æ®è®¾è®¡çš„æ•°æ®é›†åˆ†å‰²å·¥å…·æ¨¡å—ï¼Œéµå¾ª scikit-learn API çº¦å®šã€‚è¯¥æ¨¡å—è§£å†³äº†åŒ»ç–—æ•°æ®åˆ†æä¸­çš„æ ¸å¿ƒé—®é¢˜ï¼š**æ‚£è€…çº§åˆ«çš„æ•°æ®ç‹¬ç«‹æ€§**ï¼Œç¡®ä¿åŒä¸€æ‚£è€…çš„æ‰€æœ‰è®°å½•ä¸ä¼šåŒæ—¶å‡ºç°åœ¨è®­ç»ƒé›†å’Œæµ‹è¯•é›†ä¸­ï¼Œä»è€Œé¿å…æ•°æ®æ³„æ¼ã€‚

### æ ¸å¿ƒç‰¹æ€§

- âœ… **æ‚£è€…çº§åˆ†å±‚æŠ½æ ·**ï¼šä¿è¯è®­ç»ƒé›†å’Œæµ‹è¯•é›†çš„ç±»åˆ«æ¯”ä¾‹ä¸åŸå§‹æ•°æ®ä¸€è‡´
- âœ… **æ‚£è€…ç‹¬ç«‹æ€§ä¿è¯**ï¼šåŒä¸€æ‚£è€…åªå‡ºç°åœ¨ä¸€ä¸ªæ•°æ®é›†ä¸­
- âœ… **äº¤å‰éªŒè¯æ”¯æŒ**ï¼šæä¾› K æŠ˜äº¤å‰éªŒè¯ç´¢å¼•ç”Ÿæˆ
- âœ… **Sklearn å…¼å®¹**ï¼šå¯ä¸ scikit-learn Pipeline æ— ç¼é›†æˆ
- âœ… **é«˜æ€§èƒ½**ï¼šè¿”å›æ•´æ•°ç´¢å¼•ï¼Œç›´æ¥ä½¿ç”¨ `iloc[]` è®¿é—®ï¼Œæ¯” ID åŒ¹é…å¿« 10-100 å€

---

## ğŸ“¦ æ¨¡å—ç»„æˆ

| ç»„ä»¶ | ç±»å‹ | æè¿° |
|------|------|------|
| `PatientLevelStratifiedSplitter` | ç±» | åŸºç¡€çš„æ‚£è€…çº§åˆ†å±‚ 70/30 åˆ’åˆ†å™¨ |
| `PatientLevelStratifiedSplitterWithCV` | ç±» | å¸¦äº¤å‰éªŒè¯çš„æ‚£è€…çº§åˆ†å±‚åˆ†å‰²å™¨ |
| `validate_cv_indices` | å‡½æ•° | äº¤å‰éªŒè¯ç´¢å¼•æœ‰æ•ˆæ€§éªŒè¯å·¥å…· |
| `patient_level_train_test_split` | å‡½æ•° | å…¼å®¹ sklearn çš„ä¾¿æ·åˆ†å‰²å‡½æ•° |

---

## ğŸ”§ ç±»è¯¦è§£

### 1. PatientLevelStratifiedSplitter

åŸºç¡€çš„æ‚£è€…çº§åˆ«åˆ†å±‚æ•°æ®åˆ†å‰²å™¨ï¼Œç”¨äºç®€å•çš„è®­ç»ƒé›†/æµ‹è¯•é›†åˆ’åˆ†ã€‚

#### å‚æ•°

| å‚æ•° | ç±»å‹ | é»˜è®¤å€¼ | æè¿° |
|------|------|--------|------|
| `test_size` | float | 0.3 | æµ‹è¯•é›†æ¯”ä¾‹ï¼ŒèŒƒå›´ (0, 1) |
| `random_state` | int | 42 | éšæœºç§å­ï¼Œä¿è¯ç»“æœå¯å¤ç° |
| `verbose` | bool | True | æ˜¯å¦æ‰“å°åˆ’åˆ†ç»Ÿè®¡ä¿¡æ¯ |

#### å±æ€§

| å±æ€§ | ç±»å‹ | æè¿° |
|------|------|------|
| `train_indices_` | np.ndarray | è®­ç»ƒé›†åœ¨åŸå§‹æ•°æ®ä¸­çš„ç´¢å¼• |
| `test_indices_` | np.ndarray | æµ‹è¯•é›†åœ¨åŸå§‹æ•°æ®ä¸­çš„ç´¢å¼• |
| `train_size_` | int | è®­ç»ƒé›†æ ·æœ¬æ•° |
| `test_size_` | int | æµ‹è¯•é›†æ ·æœ¬æ•° |

#### æ–¹æ³•

##### `split(df, label_col, patient_id_col)`

æ‰§è¡Œæ‚£è€…çº§åˆ†å±‚åˆ’åˆ†ã€‚

**å‚æ•°ï¼š**
- `df` (pd.DataFrame): å¾…åˆ’åˆ†çš„æ•°æ®æ¡†
- `label_col` (str): æ ‡ç­¾åˆ—å
- `patient_id_col` (str): æ‚£è€… ID åˆ—åï¼Œé»˜è®¤ `"patient_id"`

**è¿”å›ï¼š**
- `train_df` (pd.DataFrame): è®­ç»ƒé›†ï¼ˆç´¢å¼•å·²é‡ç½®ï¼‰
- `test_df` (pd.DataFrame): æµ‹è¯•é›†ï¼ˆç´¢å¼•å·²é‡ç½®ï¼‰

##### `get_split_info()`

è·å–åˆ’åˆ†çš„è¯¦ç»†é…ç½®å’Œç»Ÿè®¡ä¿¡æ¯ã€‚

**è¿”å›ï¼š**
- `dict`: åŒ…å«æ–¹æ³•åã€æ¯”ä¾‹ã€éšæœºç§å­ã€æ ·æœ¬æ•°ç­‰ä¿¡æ¯

#### ä½¿ç”¨ç¤ºä¾‹

```python
from data_splitters import PatientLevelStratifiedSplitter

# åˆå§‹åŒ–åˆ†å‰²å™¨
splitter = PatientLevelStratifiedSplitter(test_size=0.3, random_state=42)

# æ‰§è¡Œåˆ’åˆ†
train_df, test_df = splitter.split(
    df, 
    label_col="CRS_grade", 
    patient_id_col="patient_id"
)

print(f"è®­ç»ƒé›†: {len(train_df)}, æµ‹è¯•é›†: {len(test_df)}")
print(f"åˆ’åˆ†ä¿¡æ¯: {splitter.get_split_info()}")
```

---

### 2. PatientLevelStratifiedSplitterWithCV

åœ¨åŸºç¡€åˆ†å‰²å™¨ä¸Šå¢åŠ äº†å†…éƒ¨äº¤å‰éªŒè¯åŠŸèƒ½ï¼Œè¿”å›å¯ç›´æ¥ç”¨äº `iloc[]` çš„æ•´æ•°ç´¢å¼•ã€‚

#### å‚æ•°

| å‚æ•° | ç±»å‹ | é»˜è®¤å€¼ | æè¿° |
|------|------|--------|------|
| `test_size` | float | 0.3 | æµ‹è¯•é›†æ¯”ä¾‹ |
| `n_folds` | int | 5 | äº¤å‰éªŒè¯æŠ˜æ•° |
| `random_state` | int | 42 | éšæœºç§å­ |

#### æ–¹æ³•

##### `split(df, label_col, patient_id_col)`

æ‰§è¡Œåˆ’åˆ†å¹¶ç”Ÿæˆäº¤å‰éªŒè¯ç´¢å¼•ã€‚

**å‚æ•°ï¼š**
- `df` (pd.DataFrame): å¾…åˆ’åˆ†çš„æ•°æ®æ¡†
- `label_col` (str): æ ‡ç­¾åˆ—å
- `patient_id_col` (str): æ‚£è€… ID åˆ—åï¼Œé»˜è®¤ `"ID"`

**è¿”å›ï¼š**
- `train_df` (pd.DataFrame): è®­ç»ƒé›†ï¼ˆç´¢å¼•å·²é‡ç½®ä¸º 0, 1, 2, ...ï¼‰
- `test_df` (pd.DataFrame): æµ‹è¯•é›†
- `cv_folds_indices` (List[Tuple[np.ndarray, np.ndarray]]): äº¤å‰éªŒè¯ç´¢å¼•åˆ—è¡¨

#### è¿”å›å€¼ç»“æ„

```python
cv_folds_indices = [
    (train_indices_fold1, val_indices_fold1),  # Fold 1
    (train_indices_fold2, val_indices_fold2),  # Fold 2
    (train_indices_fold3, val_indices_fold3),  # Fold 3
    (train_indices_fold4, val_indices_fold4),  # Fold 4
    (train_indices_fold5, val_indices_fold5),  # Fold 5
]
# æ¯ä¸ª indices éƒ½æ˜¯ np.ndarrayï¼ŒåŒ…å« DataFrame çš„è¡Œå·
```

#### ä½¿ç”¨ç¤ºä¾‹

```python
from data_splitters import PatientLevelStratifiedSplitterWithCV
from sklearn.linear_model import LogisticRegression

# åˆå§‹åŒ–åˆ†å‰²å™¨
splitter = PatientLevelStratifiedSplitterWithCV(
    test_size=0.3, 
    n_folds=5, 
    random_state=42
)

# æ‰§è¡Œåˆ’åˆ†
train_df, test_df, cv_folds = splitter.split(
    df, 
    label_col="CRS_grade", 
    patient_id_col="ID"
)

# äº¤å‰éªŒè¯è®­ç»ƒ
features = ['age', 'weight', 'biomarker1', 'biomarker2']
scores = []

for fold_idx, (train_idx, val_idx) in enumerate(cv_folds):
    # ç›´æ¥ä½¿ç”¨æ•´æ•°ç´¢å¼•æå–æ•°æ®
    X_train = train_df.iloc[train_idx][features]
    y_train = train_df.iloc[train_idx]['CRS_grade']
    
    X_val = train_df.iloc[val_idx][features]
    y_val = train_df.iloc[val_idx]['CRS_grade']
    
    # è®­ç»ƒæ¨¡å‹
    model = LogisticRegression()
    model.fit(X_train, y_train)
    
    # éªŒè¯
    score = model.score(X_val, y_val)
    scores.append(score)
    print(f"Fold {fold_idx+1} Accuracy: {score:.3f}")

print(f"å¹³å‡å‡†ç¡®ç‡: {np.mean(scores):.3f} Â± {np.std(scores):.3f}")

# æœ€ç»ˆè¯„ä¼°
final_model = LogisticRegression()
final_model.fit(train_df[features], train_df['CRS_grade'])
test_score = final_model.score(test_df[features], test_df['CRS_grade'])
print(f"æµ‹è¯•é›†å‡†ç¡®ç‡: {test_score:.3f}")
```

---

## ğŸ› ï¸ è¾…åŠ©å‡½æ•°

### validate_cv_indices

éªŒè¯äº¤å‰éªŒè¯ç´¢å¼•çš„æœ‰æ•ˆæ€§ã€‚

```python
from data_splitters import validate_cv_indices

is_valid = validate_cv_indices(train_df, cv_folds)
# æ£€æŸ¥é¡¹:
# 1. ç´¢å¼•èŒƒå›´æ˜¯å¦åˆæ³• (0 <= idx < len(train_df))
# 2. è®­ç»ƒé›†å’ŒéªŒè¯é›†æ˜¯å¦æ— é‡å 
# 3. æ¯æŠ˜çš„æ ·æœ¬æ€»æ•°æ˜¯å¦ç­‰äºè®­ç»ƒé›†å¤§å°
```

### patient_level_train_test_split

ä¸ sklearn çš„ `train_test_split` å…¼å®¹çš„ä¾¿æ·å‡½æ•°ã€‚

```python
from data_splitters import patient_level_train_test_split

# æ›¿æ¢åŸæœ‰çš„ sklearn train_test_split
train_df, test_df = patient_level_train_test_split(
    df,
    label_col="label",
    patient_id_col="patient_id",
    test_size=0.3,
    random_state=42
)
```

---

## ğŸ“Š ç®—æ³•æµç¨‹

### é˜¶æ®µ 1: æ‚£è€…çº§è®­ç»ƒ/æµ‹è¯•é›†åˆ’åˆ†

```
åŸå§‹æ•°æ® (N ä¸ªæ‚£è€…)
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Step 1.1: æå–æ‚£è€…æ ‡ç­¾       â”‚
â”‚  groupby(patient_id)[label]   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Step 1.2: åˆ†å±‚æŠ½æ ·           â”‚
â”‚  StratifiedShuffleSplit       â”‚
â”‚  (åœ¨æ‚£è€…çº§åˆ«, éæ ·æœ¬çº§åˆ«)      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Step 1.3: ç­›é€‰æ•°æ®è¡Œ         â”‚
â”‚  df[df[id].isin(train_ids)]   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Step 1.4: é‡ç½®ç´¢å¼• (å…³é”®!)    â”‚
â”‚  train_df.reset_index()       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼
   è®­ç»ƒé›† (70%)  +  æµ‹è¯•é›† (30%)
```

### é˜¶æ®µ 2: äº¤å‰éªŒè¯ç´¢å¼•ç”Ÿæˆ

```
è®­ç»ƒé›† (M ä¸ªæ‚£è€…)
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Step 2.1: æå–è®­ç»ƒé›†æ‚£è€…ä¿¡æ¯  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Step 2.2: K æŠ˜åˆ†å±‚åˆ’åˆ†        â”‚
â”‚  StratifiedKFold              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Step 2.3: æ‚£è€…ID â†’ è¡Œç´¢å¼•     â”‚
â”‚  patient_to_row_idx å­—å…¸       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼
   cv_folds_indices (K æŠ˜æ•´æ•°ç´¢å¼•)
```

---

## âš¡ æ€§èƒ½ä¼˜åŒ–

### ä¸ºä»€ä¹ˆè¿”å›æ•´æ•°ç´¢å¼•è€Œéæ‚£è€… IDï¼Ÿ

| æ–¹å¼ | ä»£ç  | å¤æ‚åº¦ |
|------|------|--------|
| **æ—§ç‰ˆæœ¬ (ID)** | `train_df[train_df['ID'].isin(ids)]` | O(n) å¸ƒå°”ç´¢å¼• |
| **æ–°ç‰ˆæœ¬ (ç´¢å¼•)** | `train_df.iloc[indices]` | O(k) ä½ç½®ç´¢å¼• |

**æ€§èƒ½æå‡ï¼š10-100 å€**ï¼ˆå–å†³äºæ•°æ®è§„æ¨¡ï¼‰

### ç´¢å¼•é‡ç½®çš„é‡è¦æ€§

```python
# é—®é¢˜: åŸå§‹ç´¢å¼•å¯èƒ½ä¸è¿ç»­
original_df.index  # [5, 12, 23, 67, 89, ...]

# è§£å†³: é‡ç½®ä¸ºè¿ç»­æ•´æ•°
train_df = train_df.reset_index(drop=True)
train_df.index  # [0, 1, 2, 3, 4, ...]

# ç°åœ¨æ•´æ•°ç´¢å¼•å¯ä»¥ç›´æ¥æ˜ å°„åˆ°è¡Œ
train_df.iloc[train_indices]  # æ­£ç¡®!
```

---

## âš ï¸ æ³¨æ„äº‹é¡¹

### æ•°æ®æ ¼å¼è¦æ±‚

1. **è¾“å…¥ DataFrame å¿…é¡»åŒ…å«**ï¼š
   - æ‚£è€… ID åˆ—ï¼ˆç”¨äºä¿è¯æ‚£è€…ç‹¬ç«‹æ€§ï¼‰
   - æ ‡ç­¾åˆ—ï¼ˆç”¨äºåˆ†å±‚æŠ½æ ·ï¼‰

2. **åŒä¸€æ‚£è€…å¯ä»¥æœ‰å¤šè¡Œæ•°æ®**ï¼š
   - å¤šæ—¶é—´ç‚¹æµ‹é‡
   - å¤šæ¬¡æ£€æµ‹ç»“æœ
   - æ—¶é—´åºåˆ—æ•°æ®

3. **æ ‡ç­¾åˆ—åº”ä¸ºç¦»æ•£åˆ†ç±»å˜é‡**ï¼š
   - äºŒåˆ†ç±»ï¼š0/1
   - å¤šåˆ†ç±»ï¼š0/1/2/...

### æ‚£è€…ç‹¬ç«‹æ€§

```
âœ… æ­£ç¡®çš„åˆ’åˆ†:
   è®­ç»ƒé›†: æ‚£è€… A, B, C (æ‰€æœ‰è®°å½•)
   æµ‹è¯•é›†: æ‚£è€… D, E, F (æ‰€æœ‰è®°å½•)

âŒ é”™è¯¯çš„åˆ’åˆ† (æ•°æ®æ³„æ¼):
   è®­ç»ƒé›†: æ‚£è€… A (éƒ¨åˆ†è®°å½•), B, C
   æµ‹è¯•é›†: æ‚£è€… A (éƒ¨åˆ†è®°å½•), D, E
```

### ä»æ—§ç‰ˆæœ¬è¿ç§»

```python
# æ—§ç‰ˆæœ¬ä»£ç 
for train_ids, val_ids in cv_folds:
    X_train = train_df[train_df["ID"].isin(train_ids)]  # æ…¢
    X_val = train_df[train_df["ID"].isin(val_ids)]

# æ–°ç‰ˆæœ¬ä»£ç 
for train_idx, val_idx in cv_folds:
    X_train = train_df.iloc[train_idx]  # å¿«!
    X_val = train_df.iloc[val_idx]
```

---

## ğŸ§ª æµ‹è¯•ç¤ºä¾‹

è¿è¡Œæ¨¡å—è‡ªå¸¦çš„æµ‹è¯•ä»£ç ï¼š

```bash
python data_splitters.py
```

è¾“å‡ºç¤ºä¾‹ï¼š
```
============================================================
æ‚£è€…çº§åˆ«åˆ†å±‚åˆ†å‰²å™¨ - æµ‹è¯•ç¤ºä¾‹
============================================================

ç¤ºä¾‹æ•°æ®é›†: 100 ä¸ªæ‚£è€…
æ ‡ç­¾åˆ†å¸ƒ: {0: 85, 1: 15}

============================================================
æµ‹è¯•1: åŸºç¡€æ‚£è€…çº§åˆ†å±‚åˆ†å‰²
============================================================
æ‰§è¡Œæ‚£è€…çº§åˆ†å±‚åˆ’åˆ†...
   æ€»æ ·æœ¬æ•°: 100
   æ ‡ç­¾åˆ†å¸ƒ: {0: 85, 1: 15}

åˆ†å±‚åˆ’åˆ†å®Œæˆ:
   è®­ç»ƒé›†: 70 æ ·æœ¬ (æ­£æ ·æœ¬: 10)
   æµ‹è¯•é›†: 30 æ ·æœ¬ (æ­£æ ·æœ¬: 5)
   è®­ç»ƒé›†æ­£æ ·æœ¬æ¯”ä¾‹: 14.29%
   æµ‹è¯•é›†æ­£æ ·æœ¬æ¯”ä¾‹: 16.67%

============================================================
æµ‹è¯•2: å¸¦äº¤å‰éªŒè¯çš„æ‚£è€…çº§åˆ†å±‚åˆ†å‰²
============================================================
è®­ç»ƒé›†å¤§å°: 70 (åŒ…å« 70 åæ‚£è€…)
æµ‹è¯•é›†å¤§å°: 30 (åŒ…å« 30 åæ‚£è€…)

æ­£åœ¨ç”Ÿæˆ 5 æŠ˜äº¤å‰éªŒè¯ç´¢å¼•...
  Fold 1: è®­ç»ƒ 56 æ ·æœ¬ (56 æ‚£è€…), éªŒè¯ 14 æ ·æœ¬ (14 æ‚£è€…)
  Fold 2: è®­ç»ƒ 56 æ ·æœ¬ (56 æ‚£è€…), éªŒè¯ 14 æ ·æœ¬ (14 æ‚£è€…)
  Fold 3: è®­ç»ƒ 56 æ ·æœ¬ (56 æ‚£è€…), éªŒè¯ 14 æ ·æœ¬ (14 æ‚£è€…)
  Fold 4: è®­ç»ƒ 56 æ ·æœ¬ (56 æ‚£è€…), éªŒè¯ 14 æ ·æœ¬ (14 æ‚£è€…)
  Fold 5: è®­ç»ƒ 56 æ ·æœ¬ (56 æ‚£è€…), éªŒè¯ 14 æ ·æœ¬ (14 æ‚£è€…)
äº¤å‰éªŒè¯ç´¢å¼•ç”Ÿæˆå®Œæˆ! å…± 5 æŠ˜

æ‰€æœ‰äº¤å‰éªŒè¯ç´¢å¼•éªŒè¯é€šè¿‡!

æ‰€æœ‰æµ‹è¯•å®Œæˆï¼
```

---

## ğŸ“š ä¾èµ–

```python
import numpy as np
import pandas as pd
from sklearn.model_selection import StratifiedShuffleSplit, StratifiedKFold
from typing import Tuple, List, Optional, Union
```

---

## ğŸ“ ç‰ˆæœ¬ä¿¡æ¯

- **ä½œè€…**: AI Assistant
- **åˆ›å»ºæ—¥æœŸ**: 2025-11-20
- **æœ€åæ›´æ–°**: 2025-12-16

---

## ğŸ“– å‚è€ƒ

- [sklearn.model_selection.StratifiedShuffleSplit](https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.StratifiedShuffleSplit.html)
- [sklearn.model_selection.StratifiedKFold](https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.StratifiedKFold.html)
- [sklearn.model_selection.GroupKFold](https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.GroupKFold.html)
