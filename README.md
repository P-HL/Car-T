# CAR-T Toxicity Prediction System

## é¡¹ç›®æ¦‚è¿°

è¿™æ˜¯ä¸€ä¸ªä¸“é—¨ç”¨äºCAR-Tç»†èƒç–—æ³•æ¯’æ€§é¢„æµ‹çš„æœºå™¨å­¦ä¹ ç³»ç»Ÿã€‚è¯¥ç³»ç»Ÿèƒ½å¤Ÿå¤„ç†æ··åˆäº†é™æ€æ‚£è€…ç‰¹å¾å’ŒåŠ¨æ€ç›‘æµ‹æ•°æ®çš„å¤æ‚åŒ»å­¦æ•°æ®ï¼Œå¹¶è¿›è¡Œå…¨é¢çš„æ¢ç´¢æ€§æ•°æ®åˆ†æï¼ˆEDAï¼‰ã€‚

## ç‰¹æ€§

- ğŸ¥ **åŒ»å­¦æ•°æ®ä¸“ç”¨**: ä¸“é—¨è®¾è®¡ç”¨äºå¤„ç†CAR-Tç–—æ³•ç›¸å…³çš„åŒ»å­¦æ•°æ®
- ğŸ“Š **æ··åˆæ•°æ®å¤„ç†**: åŒæ—¶å¤„ç†é™æ€æ‚£è€…ç‰¹å¾å’ŒåŠ¨æ€æ—¶åºç›‘æµ‹æ•°æ®
- ğŸ¯ **å¤šå±‚æ¬¡ç›®æ ‡å˜é‡**: æ”¯æŒäºŒåˆ†ç±»ã€å¤šåˆ†ç±»å’Œå¤šæ ‡ç­¾æ¯’æ€§é¢„æµ‹ä»»åŠ¡
- ğŸ“ˆ **å…¨é¢EDA**: ç”Ÿæˆè¯¦ç»†çš„æ¢ç´¢æ€§æ•°æ®åˆ†ææŠ¥å‘Šå’Œå¯è§†åŒ–
- ğŸ”§ **ä¼ä¸šçº§æ¶æ„**: éµå¾ªSOLIDåŸåˆ™ï¼Œå…·æœ‰å®Œæ•´çš„é”™è¯¯å¤„ç†å’Œæ—¥å¿—ç³»ç»Ÿ
- âœ… **é«˜è´¨é‡ä»£ç **: å®Œæ•´çš„ç±»å‹æ³¨è§£ã€å•å…ƒæµ‹è¯•å’Œæ–‡æ¡£

## é¡¹ç›®ç»“æ„

```
cart_toxicity_prediction/
â”œâ”€â”€ main.py                    # ä¸»å…¥å£æ–‡ä»¶
â”œâ”€â”€ config.yaml               # é…ç½®æ–‡ä»¶
â”œâ”€â”€ requirements.txt          # ä¾èµ–ç®¡ç†
â”œâ”€â”€ README.md                 # é¡¹ç›®æ–‡æ¡£
â”œâ”€â”€ src/                      # æºä»£ç 
â”‚   â”œâ”€â”€ interfaces/           # æ¥å£å®šä¹‰
â”‚   â”œâ”€â”€ services/            # æ•°æ®å¤„ç†æœåŠ¡
â”‚   â”œâ”€â”€ models/              # æ•°æ®æ¨¡å‹
â”‚   â”œâ”€â”€ utils/               # å·¥å…·ç±»
â”‚   â”œâ”€â”€ exceptions/          # è‡ªå®šä¹‰å¼‚å¸¸
â”‚   â”œâ”€â”€ analyzers/           # EDAåˆ†æå™¨
â”‚   â””â”€â”€ controllers/         # ä¸»æ§åˆ¶å™¨
â”œâ”€â”€ tests/                   # å•å…ƒæµ‹è¯•
â”œâ”€â”€ logs/                    # æ—¥å¿—æ–‡ä»¶
â””â”€â”€ outputs/                 # è¾“å‡ºç»“æœ
```

## å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒå‡†å¤‡

ç¡®ä¿æ‚¨çš„ç³»ç»Ÿå®‰è£…äº† Python 3.10+ï¼š

```bash
python --version  # åº”æ˜¾ç¤º 3.10.x æˆ–æ›´é«˜ç‰ˆæœ¬
```

### 2. å®‰è£…ä¾èµ–

```bash
# å…‹éš†æˆ–ä¸‹è½½é¡¹ç›®åˆ°æœ¬åœ°
cd cart_toxicity_prediction

# å®‰è£…ä¾èµ–
pip install -r requirements.txt
```

### 3. é…ç½®æ•°æ®è·¯å¾„

ç¼–è¾‘ `config.yaml` æ–‡ä»¶ï¼Œè®¾ç½®æ‚¨çš„æ•°æ®è·¯å¾„ï¼š

```yaml
data:
  static_file_path: "/path/to/your/encoded.csv"          # é™æ€æ•°æ®æ–‡ä»¶è·¯å¾„
  dynamic_data_folder: "/path/to/your/dynamic_data"      # åŠ¨æ€æ•°æ®æ–‡ä»¶å¤¹è·¯å¾„
  max_patients_test: 10                                  # æµ‹è¯•æ¨¡å¼æ‚£è€…æ•°é‡
```

### 4. è¿è¡Œåˆ†æ

```bash
python main.py
```

ç³»ç»Ÿå°†é¦–å…ˆè¿è¡Œæµ‹è¯•æ¨¡å¼ï¼ˆå¤„ç†å°‘é‡æ‚£è€…ï¼‰ï¼Œç„¶åè¯¢é—®æ˜¯å¦è¿›è¡Œå…¨é‡åˆ†æã€‚

## æ•°æ®æ ¼å¼è¦æ±‚

### é™æ€æ•°æ® (encoded.csv)

- **æ ¼å¼**: CSVæ–‡ä»¶
- **å†…å®¹**: æ¯è¡Œä¸€ä¸ªæ‚£è€…ï¼ŒåŒ…å«ä»¥ä¸‹åˆ—ï¼š
  - äººå£ç»Ÿè®¡å­¦ä¿¡æ¯ï¼šAge, Sex
  - ä¸´åºŠç‰¹å¾ï¼šDisease, BM_disease_burden, ç­‰
  - æ¯’æ€§æŒ‡æ ‡ï¼šCRS_grade, ICANS_grade, Early_ICAHT_grade, Late_ICAHT_grade, Infection_grade

### åŠ¨æ€æ•°æ®

- **æ ¼å¼**: å¤šä¸ªCSVæ–‡ä»¶ï¼Œæ¯ä¸ªæ‚£è€…ä¸€ä¸ªæ–‡ä»¶
- **å‘½å**: `pt_1.csv`, `pt_2.csv`, ..., `pt_1000.csv`
- **å†…å®¹**: æ¯ä¸ªæ–‡ä»¶åŒ…å«è¯¥æ‚£è€…100å¤©çš„ç›‘æµ‹æ•°æ®ï¼Œ92ä¸ªåŠ¨æ€å˜é‡

## è¾“å‡ºç»“æœ

### 1. å¯è§†åŒ–å›¾è¡¨

åœ¨ `outputs/` æ–‡ä»¶å¤¹ä¸­ç”Ÿæˆä»¥ä¸‹å›¾è¡¨ï¼š

- `missing_values_analysis.png` - ç¼ºå¤±å€¼åˆ†æ
- `target_distribution.png` - ç›®æ ‡å˜é‡åˆ†å¸ƒ
- `numeric_distributions.png` - æ•°å€¼å˜é‡åˆ†å¸ƒ
- `categorical_distributions.png` - åˆ†ç±»å˜é‡åˆ†å¸ƒ
- `correlation_heatmap.png` - ç›¸å…³æ€§çƒ­å›¾
- `outlier_summary.png` - å¼‚å¸¸å€¼æ€»ç»“
- `dynamic_missing_patterns.png` - åŠ¨æ€æ•°æ®ç¼ºå¤±æ¨¡å¼
- `dynamic_temporal_trends.png` - æ—¶åºè¶‹åŠ¿åˆ†æ
- `dynamic_variable_distributions.png` - åŠ¨æ€å˜é‡åˆ†å¸ƒ
- `dynamic_patient_variability.png` - æ‚£è€…é—´å˜å¼‚æ€§

### 2. æ—¥å¿—æ–‡ä»¶

åœ¨ `logs/` æ–‡ä»¶å¤¹ä¸­ç”Ÿæˆè¯¦ç»†çš„åˆ†ææ—¥å¿—ï¼š

- `cart_analysis.log` - å®Œæ•´çš„åˆ†æè¿‡ç¨‹æ—¥å¿—

### 3. åˆ›å»ºçš„ç›®æ ‡å˜é‡

ç³»ç»Ÿä¼šè‡ªåŠ¨åˆ›å»ºä»¥ä¸‹ç›®æ ‡å˜é‡ï¼š

- `Overall_Severe_Toxicity` - æ€»ä½“ä¸¥é‡æ¯’æ€§ï¼ˆäºŒåˆ†ç±»ï¼‰
- `Severe_CRS_grade_Occurred` - CRSä¸¥é‡æ¯’æ€§
- `Severe_ICANS_grade_Occurred` - ICANSä¸¥é‡æ¯’æ€§
- `Severe_Early_ICAHT_grade_Occurred` - æ—©æœŸICAHTä¸¥é‡æ¯’æ€§
- `Severe_Late_ICAHT_grade_Occurred` - æ™šæœŸICAHTä¸¥é‡æ¯’æ€§
- `Severe_Infection_grade_Occurred` - æ„ŸæŸ“ä¸¥é‡æ¯’æ€§
- `Max_Toxicity_Grade` - æœ€é«˜æ¯’æ€§ç­‰çº§
- `Severe_Toxicity_Count` - ä¸¥é‡æ¯’æ€§è®¡æ•°
- `Toxicity_Severity_Score` - æ¯’æ€§ä¸¥é‡ç¨‹åº¦è¯„åˆ†

## å¿«é€Ÿä½¿ç”¨æŒ‡å—

è¿è¡Œç³»ç»Ÿå‰ï¼Œè¯·å…ˆä¿®æ”¹é…ç½®æ–‡ä»¶ä¸­çš„æ•°æ®è·¯å¾„ï¼Œç„¶åç›´æ¥è¿è¡Œï¼š

```bash
python main.py
```
------------------------------------------------------------------------------------
